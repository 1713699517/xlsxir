<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.11.4">
    <title>Xlsxir – Xlsxir v1.2.0</title>
    <link rel="stylesheet" href="dist/app-1e374caa3d.css" />
    <script src="dist/sidebar_items.js"></script>
  </head>
  <body data-type="extras">

<div class="main">
<button class="sidebar-toggle">
  <i class="icon-menu"></i>
</button>
<section class="sidebar">
  <button class="sidebar-toggle">
    <i class="icon-menu"></i>
  </button>

  
  <a href="overview.html" class="sidebar-projectLink">
    <div class="sidebar-projectDetails">
      <h1 class="sidebar-projectName">
        Xlsxir
      </h1>
      <h2 class="sidebar-projectVersion">
        v1.2.0
      </h2>
    </div>
    
  </a>

  <div class="sidebar-search">
    <i class="icon-search"></i>
    <input type="text" class="sidebar-searchInput" placeholder="search" autocomplete="off" />
  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">Pages</a></li>

    
      <li><a id="modules-list" href="#full-list">Modules</a></li>
    

    

    
  </ul>

  <ul id="full-list" class="sidebar-fullList"></ul>
  <div class="sidebar-noResults"></div>
</section>

<section class="content">
  <div id="content" class="content-inner">


<h1>Xlsxir</h1>
<p>Xlsxir is an Elixir library that parses <code class="inline">.xlsx</code> files using Simple API for XML (SAX) parsing via the <a href="https://github.com/willemdj/erlsom">Erlsom</a> Erlang library, extracts the data to an Erlang Term Storage (ETS) process and provides various functions for accessing the data. Xlsxir supports ISO 8601 date formats and large files. Testing has been limited to various documents I have created or have access to and any issues submitted through GitHub, though I have succesfully parsed a worksheet containing 100 rows and 514K columns. Please submit any issues found and they will be addressed ASAP.  </p>
<h2 id="installation"> Installation</h2><p>You can add Xlsxir as a dependancy to your Elixir project via the Hex package manager by adding the following to your <code class="inline">mix.exs</code> file: </p>
<pre><code class="elixir">def deps do
  [ {:xlsxir, &quot;~&gt; 1.2&quot;} ]
end</code></pre>
<p>Or, you can directly reference the GitHub repo:</p>
<pre><code class="elixir">def deps do
  [ {:xlsxir, github: &quot;kennellroxco/xlsxir&quot;} ]
end</code></pre>
<h2 id="basic-usage"> Basic Usage</h2><p>Xlsxir parses a <code class="inline">.xlsx</code> file located at a given <code class="inline">path</code> and extracts the data to an ETS process via the <a href="Xlsxir.html#extract/3"><code class="inline">Xlsxir.extract/3</code></a> function:</p>
<pre><code class="elixir">Xlsxir.extract(path, index, timer \\ false)</code></pre>
<p>Argument descriptions:</p>
<ul>
<li><code class="inline">path</code> the path of the file to be parsed in <code class="inline">string</code> format
</li>
<li><code class="inline">index</code> is the position of the worksheet you wish to parse (zero-based index)
</li>
<li><code class="inline">timer</code> is a boolean flag that controls an extraction timer that returns time elapsed when set to <code class="inline">true</code>. Defalut value is <code class="inline">false</code>.
</li>
</ul>
<p>Upon successful completion, the extraction process returns: </p>
<ul>
<li><code class="inline">:ok</code> with <code class="inline">timer</code> set to <code class="inline">false</code>
</li>
<li><code class="inline">{:ok, time_elapsed}</code> with <code class="inline">timer</code> set to <code class="inline">true</code>
</li>
</ul>
<p><br/>
The extracted worksheet data can be accessed using any of the following functions:</p>
<pre><code class="elixir">Xlsxir.get_list
Xlsxir.get_map
Xlsxir.get_mda
Xlsxir.get_cell(cell_ref)
Xlsxir.get_row(row_num)
Xlsxir.get_col(col_ltr)
Xlsxir.get_info(num_type)</code></pre>
<p><a href="Xlsxir.html#get_list/0"><code class="inline">Xlsxir.get_list/0</code></a> returns entire worksheet in a list of row lists (i.e. <code class="inline">[[row 1 values], ...]</code>)<br/>
<a href="Xlsxir.html#get_map/0"><code class="inline">Xlsxir.get_map/0</code></a> returns entire worksheet in a map of cell names and values (i.e. <code class="inline">%{&quot;A1&quot; =&gt; value, ...}</code>)<br/>
<a href="Xlsxir.html#get_mda/0"><code class="inline">Xlsxir.get_mda/0</code></a> returns entire worksheet in an indexed map which can be accessed like a multi-dimensional array (i.e. <code class="inline">some_var[0][0]</code> for cell “A1”)<br/>
<a href="Xlsxir.html#get_cell/1"><code class="inline">Xlsxir.get_cell/1</code></a> returns value of specified cell (i.e. <code class="inline">&quot;A1&quot;</code> returns value contained in cell A1)<br/>
<a href="Xlsxir.html#get_row/1"><code class="inline">Xlsxir.get_row/1</code></a> returns values of specified row (i.e. <code class="inline">1</code> returns the first row of data)<br/>
<a href="Xlsxir.html#get_col/1"><code class="inline">Xlsxir.get_col/1</code></a> returns values of specified column (i.e. <code class="inline">&quot;A&quot;</code> returns the first column of data)<br/>
<a href="Xlsxir.html#get_info/1"><code class="inline">Xlsxir.get_info/1</code></a> returns count data for <code class="inline">num_type</code> specified (i.e. <code class="inline">:rows</code>, <code class="inline">:cols</code>, <code class="inline">:cells</code>, <code class="inline">:all</code>)<br/></p>
<p>Once the table data is no longer needed, run the following function to delete the ETS process and free memory:</p>
<pre><code class="elixir">Xlsxir.close </code></pre>
<p>Be sure to <a href="https://hexdocs.pm/xlsxir/Xlsxir.html#close/0">close an open ETS process before trying to parse another worksheet</a> in the same session or process. If you try to open a new <code class="inline">:worksheet</code> ETS process when one already exists, you will get an error.</p>
<p>Refer to <a href="https://hexdocs.pm/xlsxir/api-reference.html">API Reference</a> for more detailed examples. </p>
<h2 id="considerations"> Considerations</h2><p>Cell references are formatted as a string (i.e. “A1”). Strings will be returned as type <code class="inline">string</code>, resulting values for functions from within the worksheet are returned as type <code class="inline">string</code>, <code class="inline">integer</code> or <code class="inline">float</code> depending on the type of the resulting value, data formatted as a number in the worksheet will be returned as type <code class="inline">integer</code> or <code class="inline">float</code>, and ISO 8601 date formatted values will be returned in Erlang <code class="inline">:calendar.date()</code> type format (i.e. <code class="inline">{year, month, day}</code>). Xlsxir does not currently support dates prior to 1/1/1900.</p>
<h2 id="contributing"> Contributing</h2><p>Contributions are encouraged. Feel free to fork the <a href="https://github.com/kennellroxco/xlsxir">repo</a>, add your code along with appropriate tests and documentation (ensuring all existing tests continue to pass) and submit a pull request. </p>
<h2 id="bug-reporting"> Bug Reporting</h2><p>Please report any bugs or request future enhancements via the <a href="https://github.com/kennellroxco/xlsxir/issues">Issues</a> page. </p>

    <footer class="footer">
      <p>
        <span class="line">
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" rel="help" target="_blank">ExDoc</a> (v0.11.4),
        </span>
        <span class="line">
          designed by
          <a href="https://twitter.com/dignifiedquire" target="_blank" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
      </p>
      <button class="night-mode-toggle" />
    </footer>
  </div>
</section>
</div>
  <script src="dist/app-6d2e071366.js"></script>
  </body>
</html>

